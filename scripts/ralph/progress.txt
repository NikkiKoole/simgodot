## Codebase Patterns
- This is a Godot 4.5 project using GDScript
- Use `class_name` at top of scripts for global class registration
- Use type hints throughout (e.g., `var name: String = ""`)
- Use `@export` for inspector-visible properties
- Enums defined within classes using `enum EnumName { VALUE1, VALUE2 }`
- Signals declared with typed parameters (e.g., `signal value_changed(new_value: float)`)
- ColorRect named "Sprite2D" used for visual representation in scenes
- Run Godot validation: `"/Users/nikkikoole/Downloads/Godot 3.app/Contents/MacOS/Godot" --headless --import --quit` (use --import to catch script errors)

- ItemContainer class (renamed from Container to avoid Godot reserved name conflict) uses typed arrays: `Array[ItemEntity]` and `Array[String]`
- Avoid Godot reserved class names: Container, Node, Control, etc. - use prefixes like ItemContainer
- Station uses Marker2D children for slots/footprint - auto-discovered by name prefix (InputSlot*, OutputSlot*, AgentFootprint)
- Slot items tracked via Dictionary mapping slot_index to ItemEntity
- Resources (extending Resource) use class_name for global registration and are saved as .tres files
- Resources directory: resources/recipes/ for recipe-related resources

---

## 2026-01-09 - US-004
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented RecipeStep class extending Resource for defining individual steps in interaction sequences
- Added properties: station_tag (String), action (String), duration (float), animation (String)
- Added input_transform Dictionary for item state transformations (e.g., {"raw_food": "prepped_food"})
- Added helper methods: get_transformed_tag(), transforms_item(), get_transform_inputs(), get_transform_outputs()
- Created example_step_prep.tres as example resource file
- Files changed:
  - scripts/recipe_step.gd (new)
  - resources/recipes/example_step_prep.tres (new)
- **Learnings for future iterations:**
  - Resources extend Resource class, not Node2D
  - Resources are saved as .tres files with [gd_resource] header
  - Use script_class attribute in .tres for typed resources
  - Helper methods make it easier to work with transform dictionaries

---

## 2026-01-09 - US-003
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented Station class extending Node2D for smart stations (stove, toilet, TV)
- Added station_tag property for identifying station type
- Added input_slots and output_slots as arrays of Marker2D
- Added agent_footprint Marker2D for agent standing position
- Added reserved_by property with reserve(), release(), is_available() methods
- Implemented get_item_in_slot(), place_item_in_slot() methods with input/output variants
- Added auto-discovery of Marker2D children by name prefix (InputSlot*, OutputSlot*, AgentFootprint)
- Created station.tscn scene with blue-gray ColorRect visual (48x48 pixels)
- Files changed:
  - scripts/station.gd (new)
  - scenes/objects/station.tscn (new)
- **Learnings for future iterations:**
  - Station uses Dictionary (input_slot_items, output_slot_items) to track items by slot index
  - Marker2D nodes auto-discovered by name prefix for convenience
  - Items placed in slots are reparented to station and positioned at slot marker
  - get_agent_position() returns global position where agent should stand
  - Convenience methods like get_input_item(), place_output_item() simplify common operations

---

## 2026-01-09 - US-002
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented ItemContainer class extending Node2D for storing ItemEntity references (renamed from Container to avoid Godot reserved name conflict)
- Added capacity property with has_space() check
- Added allowed_tags array for filtering (empty = allow all)
- Implemented add_item(), remove_item(), find_item_by_tag() methods
- Implemented get_available_items() returning unreserved items
- Added helper methods: get_available_items_by_tag(), has_available_item(), get_available_count()
- Created container.tscn scene with brown ColorRect visual (32x32 pixels)
- Files changed:
  - scripts/container.gd (new)
  - scenes/objects/container.tscn (new)
- **Learnings for future iterations:**
  - ItemContainer reparents items when added (item becomes child of container)
  - Use typed arrays like `Array[ItemEntity]` for type safety
  - ItemContainer uses is_tag_allowed() to validate before adding items
  - get_available_items() filters out reserved items using item.is_reserved()
  - IMPORTANT: "Container" is a reserved Godot class name - use ItemContainer instead

---

## 2026-01-09 - US-001
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented ItemEntity class extending Node2D with all required properties
- Created ItemState enum (RAW, PREPPED, COOKED, DIRTY, BROKEN)
- Created ItemLocation enum (IN_CONTAINER, IN_HAND, IN_SLOT, ON_GROUND)
- Added reservation system with reserve_item(), release_item(), is_reserved() methods
- Added state/location change methods with signals
- Created item_entity.tscn scene for spawning items
- Files changed:
  - scripts/item_entity.gd (new)
  - scenes/objects/item_entity.tscn (new)
- **Learnings for future iterations:**
  - Godot 4 uses `@export` instead of `export`
  - Scenes use `.tscn` format with `[gd_scene]` header
  - Scene files need `uid://` for unique identification
  - Scripts are attached via `ExtResource` in scene files
  - Project runs from command line with `--headless --quit` flags for validation
---
